{{ define "main" }}

<div class="row justify-content-center">
  <h5>/layout/recettes/list</h5>
  <h2>{{.Title}}</h2>

  {{ $pages := where .Site.RegularPages "Section" "recettes"}}

  {{ $sections := .Site.Params.mainSections }}

  {{ $categories := $.Site.Taxonomies.categories.ByCount }}

  {{ $.Scratch.Set "untagged" 0 }}
  {{ range $pages }}
  {{ with .Params.categories }}{{ else }}{{ $.Scratch.Add "untagged" 1 }}{{ end
  }}
  {{ end }}

  {{ $regime := $.Site.Taxonomies.regime.ByCount }}

  {{ $.Scratch.Set "untagged" 0 }}
  {{ range $pages }}
  {{ with .Params.regime }}{{ else }}{{ $.Scratch.Add "untagged" 1 }}{{ end }}
  {{ end }}

  <h4>Categories</h4>
<button id="selectAllcategories" onclick="htf.showAll('categories')">
  All categories
</button>
{{ range $.Scratch.Get "categories" }}
  <button class="categories-button" id="categories-{{ . | replaceRE "[.]" "_" | urlize }}" onclick="htf.checkFilter('{{ . | replaceRE "[.]" "_" | urlize }}', 'categories-')">
    {{ . }} <span id="scategories-{{ . | replaceRE "[.]" "_" | urlize }}"> -count-</span> | <span id="ccategories-{{ . | replaceRE "[.]" "_" | urlize }}"> -count-</span>
    
  </button>
{{ end }}
{{ if gt ( $.Scratch.Get "nocategories") 0 }}
<button class="categories-button" id="categories-no-categories" onclick="htf.checkFilter('no-categories', 'categories-')">
  No categories <span id="scategories-no-categories"> -count-</span> | <span id="ccategories-no-categories"> -count-</span>
</button>
{{ end }}

  <h4>Regime</h4>
<button id="selectAllregime" onclick="htf.showAll('regime')">
  All regime
</button>
{{ range $.Scratch.Get "regime" }}
  <button class="regime-button" id="regime-{{ . | replaceRE "[.]" "_" | urlize }}" onclick="htf.checkFilter('{{ . | replaceRE "[.]" "_" | urlize }}', 'regime-')">
    {{ . }} <span id="sregime-{{ . | replaceRE "[.]" "_" | urlize }}"> -count-</span> | <span id="cregime-{{ . | replaceRE "[.]" "_" | urlize }}"> -count-</span>
    
  </button>
{{ end }}
{{ if gt ( $.Scratch.Get "noregime") 0 }}
<button class="regime-button" id="regime-no-regime" onclick="htf.checkFilter('no-regime', 'regime-')">
  No regime <span id="sregime-no-regime"> -count-</span> | <span id="cregime-no-regime"> -count-</span>
</button>
{{ end }}


  <div>
    <h2><span id="selectedItemCount"></span> Items</h2>
  </div>
  <div class="tf-items-container">
    {{ range $pages.ByPublishDate.Reverse }}
    <div class="tf-filter-item tf-item" data-categories="{{ with .Params.categories }}{{ range . }}{{ . | replaceRE "[.]" "_" | urlize }} {{ end }}{{ else }} tfuntagged{{ end }}"
      data-regime="{{ with .Params.regime }}{{ range . }}{{ . | replaceRE "[.]" "_" | urlize }} {{ end }}{{ else }} tfuntagged{{ end }}">
      <h6>{{.Section}}</h6>
      <h5>{{ with .Params.regime }}{{ if eq ( printf "%T" . ) "string"
        }}{{.|humanize|title}}{{ else if eq ( printf "%T" . ) "[]string" }}{{
        range . }}{{.|humanize|title}} {{end}}{{end}}{{else}}No regime{{end}}</h5>

      <h4><a href="{{ .RelPermalink }}">{{ .Title }}</a></h4>

      <div>{{ with .Params.categories }}{{ range . }}<tag>{{ . | humanize |
          title }}</tag> {{ end }}{{ else }}<tag>untagged</tag>{{ end }}</div>

    </div>
    {{ end }}
  </div>

<script type="text/javascript" src="{{ "js/vendor/htf/hugotagsfilter.js" | relURL}}"></script>
<script type="text/javascript">
   var htfConfig = {
filters: [
     {
        name: 'categories',
        prefix: 'categories-',
        buttonClass: 'categories-button',
        allSelector: '#SelectAllCaterogies',
        attrName: 'data-categories',
        selectedPrefix: 'scategories-',
        countPrefix: 'ccategories-',
      },
      {
        name: 'regime',
        prefix: 'regime-',
        buttonClass: 'regime-button',
        allSelector: '#tfSelectAllRegimes',
        attrName: 'data-regime',
        selectedPrefix: 'sregime-',
        countPrefix: 'cregime-',
      }
    ],

  showItemClass: "show-item",
  filterItemClass: "tf-filter-item",
  activeButtonClass: "active",
  counterSelector: "selectedItemCount",
  populateCount: false,
  setDisabledButtonClass: "disable-button"
}


var htf = new HugoTagsFilter(htfConfig);
</script>

  {{ end }}



